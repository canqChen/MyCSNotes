# MD5

* **MD5信息摘要算法**（MD5 Message-Digest Algorithm），一种被广泛使用的密码散列函数，可以产生出一个**128位**（16字节）的散列值（hash value），用于确保信息传输完整一致
* 1996年后该算法被证实存在弱点，可以被加以破解，对于需要高度安全性的数据，专家一般建议改用其他算法，如SHA-2等

* 算法原理

  * 经过程序流程，生成四个32位数据，最后联合起来成为一个128-bits散列。基本方式为，求余、取余、调整长度、与链接变量进行循环运算

* 算法流程

  * 按位补充数据

    * 在MD5算法中，首先需要对信息进行填充，这个数据按位(bit)补充，要求最终的位数对512求模的结果为448。也就是说数据补位后，其位数长度只差64位(bit)就是512的整数倍，**即便是这个数据的位数对512求模的结果正好是448也必须进行补位**
    * 补位的实现过程：首先在数据后补一个1 bit； 接着在后面补上一堆0 bit, 直到整个数据的位数对512求模的结果正好为448。总之，至少补1位，而最多可能补512位

  * 扩展长度

    * 在完成补位工作后，又将一个**表示数据原始长度**的64 bit数(这是对原始数据没有补位前长度的描述，用二进制来表示)**补在最后**。当完成补位及补充数据的描述后，得到的结果数据长度正好是512的整数倍。也就是说长度正好是16个(32bit) 字的整数倍

  * 初始化MD缓存器

    * MD5运算要用到一个128位的MD5缓存器，用来保存中间变量和最终结果。该缓存器又可看成是4个32位的寄存器A、B、C、D，初始化为(大段表示)
      * A ： 01 23 45 67
      * B： 89 ab cd ef
      * C： fe dc ba 98
      * D： 76 54 32 10

  * 处理数据段

    * 首先定义4个非线性函数F、G、H、I，对输入的报文运算以512位数据段为单位进行处理。对每个数据段都要进行4轮的逻辑处理，在4轮中分别使用4个不同的函数F、G、H、I。每一轮以ABCD和当前的512位的块为输入，处理后送入ABCD覆盖旧值(128位)作为下一轮的输入

      <img src="imgs/encryption%20algorithm/md51.png" alt="md51" style="zoom:80%;" />

  * 输出

    * 信息摘要最终处理成以A, B, C, D 的形式输出。也就是开始于A的低位在前的顺序字节，结束于D的高位在前的顺序字节

* 流程图

  <img src="imgs/encryption%20algorithm/md52.png" alt="md52" style="zoom:80%;" />